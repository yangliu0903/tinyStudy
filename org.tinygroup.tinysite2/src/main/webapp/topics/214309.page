#pageTitle("topic" "topic")
#title("Tiny框架" "TinyINI开源了~~ ")
#[[<div class="BlogContent"><span id="OSC_h1_1"></span><h1>序言</h1><p>周六晚上，稍有点空，就想着是不是做一个INI的处理器？</p><p>它应该具有如下特性：</p><p></p><ol><li><span style="line-height:1.5;font-size:12.5px;">支持匿名Section</span></li><li><span style="line-height:1.5;font-size:12.5px;">支持有名Section</span></li><li><span style="line-height:1.5;font-size:12.5px;">相同Section中支持同名键值</span></li><li><span style="line-height:1.5;font-size:12.5px;">支持注释</span></li><li>支持转码</li><li>支持流式读入</li><li>支持流式写出</li><li>可以方便的对INI内容进行修改</li><li>可以方便的对INI内容进行获取</li></ol><p>说干就干，主要的程序1个小时就写完了，但是在正则匹配方面碰到了困难，弄了快2个小时还是没有解决彻底，幸好北京的<strong><span style="color:#E53333;">开涛</span></strong>同学，出手相助给解决了。</p><p>今天进行了一下重构和测试，基本上比较舒服了，于是写篇文章进行总结：</p><span id="OSC_h1_2"></span><h1>类结构</h1><p><img src="http://static.oschina.net/uploads/space/2014/0330/142522_VPWR_1245989.png" alt=""></img></p><p>对于INI的描述，采用了三个类来进行描述，一个INI文件对应于一个Sections，一个Sections可以包含多个Section，暂时不支持同名Section。</p><p>一个Section可以包含多个值对。</p><span id="OSC_h1_3"></span><h1>对INI结构的操作</h1><p><img src="http://static.oschina.net/uploads/space/2014/0330/142738_BpL1_1245989.png" alt=""></img></p><p>对于INI的操作，最后是由IniOperator进行的，它从三个接口继承而来，三个接口分别对应于基础操作，值对操作和值操作。</p><span id="OSC_h1_4"></span><h1>代码实现统计</h1><p><img src="http://static.oschina.net/uploads/space/2014/0330/142952_1wNe_1245989.png" alt=""></img></p><p>从上面的统计看，总共的代码行数是451行--一开始没有加对注释的支持，只有300行左右，由于增加了注释方面的支持，容量增加了50%。</p><span id="OSC_h1_5"></span><h1>示例</h1><p></p><pre class="brush:java; toolbar: true; auto-links: false;">String string = &quot;;abc\naa=bb;ccc\r\n[ccc];ddd\naa=bb;ccdd\r\nccc=ddd;aa;bb;cc&quot;;
        operator.read(new StringBufferInputStream(string), &quot;UTF-8&quot;);
        operator.write(System.out, &quot;UTF-8&quot;);</pre><p><br></br></p><p><br></br></p>运行结果：<p></p><p></p><pre class="brush:xml; toolbar: true; auto-links: false;">;abc
aa=bb;ccc
[ccc];ddd
aa=bb;ccdd
ccc=ddd;aa;bb;cc</pre><p><br></br></p><p><br></br></p>当然取值，赋值自然不在话下，不仅可以还方便，不信看看上面的操作接口就知道了。<p></p><span id="OSC_h1_6"></span><h1>总结</h1><p>欢迎大家获取TinyIni并提出修改意见。</p><p>源码地址：</p><p></p><p>http://git.oschina.net/tinyframework/tiny/</p><p></p><p>http://git.oschina.net/tinyframework/tiny/tree/master/framework/org.tinygroup.ini</p><p>问题列表</p><p>http://git.oschina.net/tinyframework/tiny/issues</p><p></p></div>]]#